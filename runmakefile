#! /bin/bash
# runmakefile
# Geoffrey Hannigan
# Pat Schloss Lab
# University of Michigan
# Use this to submit the makefile to the server

#PBS -N runmakefile-conjviribus
#PBS -q fluxod
#PBS -l qos=flux
#PBS -l nodes=1:ppn=4,mem=32GB
#PBS -l walltime=50:00:00
#PBS -j oe
#PBS -V
#PBS -A pschloss_fluxod

# Set the proper R module
module load R/3.3.3
module load virsorter
module load perl-modules
module load bioperl/1.6.1
module load bowtie2

# Set working directory
cd /nfs/turbo/schloss-lab/ghannig/Hannigan-2016-ConjunctisViribus || exit

# Run contig validation loop
percents=( 0.9 0.8 0.7 0.6 0.5 )
for i in "${percents[@]}"; do
	mkdir -p ./data/SecondaryBenchmarkingSet_${i}
	bash ./bin/BenchmarkingModel_SecondaryValidation.sh ./data/genbankPhageHost/VirRef/virus.fragment.${i}.fa ./data/genbankPhageHost/BacRef/bacteria.fragment.${i}.fa ./data/SecondaryBenchmarkingSet_${i}/BenchmarkCrisprsFormat_${i}.tsv ./data/SecondaryBenchmarkingSet_${i}/BenchmarkProphagesFormatFlip_${i}.tsv ./data/SecondaryBenchmarkingSet_${i}/MatchesByBlastxFormatOrder_${i}.tsv ./data/SecondaryBenchmarkingSet_${i}/PfamInteractionsFormatScoredFlip_${i}.tsv "SecondaryBenchmarkingSet_${i}"
done

